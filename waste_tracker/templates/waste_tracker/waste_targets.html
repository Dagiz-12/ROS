<!-- templates/waste_tracker/waste_targets.html -->
{% extends "admin_panel/admin_base.html" %}
{% load static %}

{% block title %}Waste Targets{% endblock %}

{% block page_title %}Waste Reduction Targets{% endblock %}
{% block page_subtitle %}Set and track waste reduction goals{% endblock %}

{% block page_actions %}
<button id="create-target" class="btn btn-primary">
    <i class="fas fa-plus mr-2"></i>Create Target
</button>
{% endblock %}

{% block content %}
<div class="waste-targets-container">
    <!-- Progress Summary -->
    <div class="progress-summary mb-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold">Progress Overview</h3>
            <div class="flex space-x-2">
                <select id="period-filter" class="p-2 border border-gray-300 rounded-lg">
                    <option value="all">All Periods</option>
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
                <select id="status-filter" class="p-2 border border-gray-300 rounded-lg">
                    <option value="all">All Status</option>
                    <option value="on-track">On Track</option>
                    <option value="at-risk">At Risk</option>
                    <option value="off-track">Off Track</option>
                </select>
            </div>
        </div>
        
        <div id="progress-summary" class="mb-6">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>

    <!-- Targets Grid -->
    <div class="targets-grid">
        <h3 class="text-lg font-bold mb-4">Waste Reduction Targets</h3>
        <div id="targets-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Targets will be loaded here -->
        </div>
    </div>
</div>

<!-- Create/Edit Target Modal -->
<div id="create-target-modal" class="modal hidden">
    <div class="modal-content max-w-2xl">
        <div class="modal-header">
            <h3 class="modal-title">Create New Target</h3>
            <button onclick="window.wasteTargetsManager?.closeCreateModal()" class="modal-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <form id="target-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div class="form-group">
                        <label for="target-name" class="block text-sm font-medium text-gray-700 mb-1">
                            Target Name *
                        </label>
                        <input type="text" id="target-name" name="name" required
                               class="w-full p-2 border border-gray-300 rounded-lg"
                               placeholder="e.g., Reduce vegetable waste by 20%">
                    </div>
                    
                    <div class="form-group">
                        <label for="target-type" class="block text-sm font-medium text-gray-700 mb-1">
                            Target Type *
                        </label>
                        <select id="target-type" name="target_type" required
                                class="w-full p-2 border border-gray-300 rounded-lg">
                            <option value="cost_reduction">Cost Reduction</option>
                            <option value="quantity_reduction">Quantity Reduction</option>
                            <option value="percentage_reduction">Percentage Reduction</option>
                            <option value="waste_per_sale">Waste per Sale</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="target-period" class="block text-sm font-medium text-gray-700 mb-1">
                            Period *
                        </label>
                        <select id="target-period" name="period" required
                                class="w-full p-2 border border-gray-300 rounded-lg">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="target-value" class="block text-sm font-medium text-gray-700 mb-1">
                            Target Value *
                        </label>
                        <input type="number" id="target-value" name="target_value" required step="0.01"
                               class="w-full p-2 border border-gray-300 rounded-lg"
                               placeholder="e.g., 1000.00">
                        <p class="text-xs text-gray-500 mt-1">Enter amount in currency or percentage</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="start-date" class="block text-sm font-medium text-gray-700 mb-1">
                            Start Date *
                        </label>
                        <input type="date" id="start-date" name="start_date" required
                               class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div class="form-group">
                        <label for="end-date" class="block text-sm font-medium text-gray-700 mb-1">
                            End Date *
                        </label>
                        <input type="date" id="end-date" name="end_date" required
                               class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                </div>
                
                <div class="form-group mb-4">
                    <label for="target-description" class="block text-sm font-medium text-gray-700 mb-1">
                        Description
                    </label>
                    <textarea id="target-description" name="description" rows="3"
                              class="w-full p-2 border border-gray-300 rounded-lg"
                              placeholder="Describe the target and its objectives..."></textarea>
                </div>
                
                <div class="form-group mb-4">
                    <label for="alert-threshold" class="block text-sm font-medium text-gray-700 mb-1">
                        Alert Threshold (%)
                    </label>
                    <input type="number" id="alert-threshold" name="alert_threshold" min="1" max="100"
                           class="w-full p-2 border border-gray-300 rounded-lg" value="10">
                    <p class="text-xs text-gray-500 mt-1">Receive alerts when target is at risk</p>
                </div>
            </form>
        </div>
        
        <div class="modal-footer">
            <button onclick="window.wasteTargetsManager?.closeCreateModal()" 
                    class="btn btn-secondary">Cancel</button>
            <button onclick="window.wasteTargetsManager?.createTarget()" 
                    class="btn btn-primary" id="save-target-btn">
                <i class="fas fa-save mr-2"></i>Save Target
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/waste_tracker/waste-targets.js' %}"></script>
{% endblock %}