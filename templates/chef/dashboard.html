<!-- templates/chef/dashboard.html - MODIFIED HEAD SECTION -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kitchen Display - Chef Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Custom CSS -->
    <link href="/static/css/styles.css" rel="stylesheet" />

    <style>
      /* Keep only essential inline styles */
      .order-card {
        transition: all 0.3s ease;
      }
      .order-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }
      .column {
        min-height: 500px;
      }
      .timer {
        font-family: "Courier New", monospace;
        font-weight: bold;
      }
      .priority-high {
        border-left: 4px solid #ef4444;
      }
      .priority-normal {
        border-left: 4px solid #10b981;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }
      .new-order {
        animation: pulse 1s infinite;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-white">
    <!-- CSRF Token for AJAX requests -->
    {% csrf_token %}
    
    <!-- Navigation -->
    <nav
      class="bg-gray-800 shadow-lg px-4 py-3 flex items-center justify-between"
    >
      <div class="flex items-center space-x-4">
        <a href="/" class="text-white font-semibold">ROS</a>
        <span class="text-gray-400 text-sm">Kitchen</span>
      </div>
      <div class="flex items-center space-x-3">
        <div class="text-sm text-gray-300 mr-4">
          Signed in as <strong id="chefNameNav">{{ user.username }}</strong>
        </div>
        <button
          id="logout-btn"
          class="px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm"
        >
          Logout
        </button>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-6">
      <div class="flex items-center justify-between mb-6">
        <div>
          <h1 class="text-2xl font-bold">Kitchen Display</h1>
          <div class="text-sm text-gray-400">
            Chef: <span id="chefName">{{ user.username }}</span>
          </div>
        </div>

        <!-- In templates/chef/dashboard.html -->
<div class="bg-white rounded-lg shadow p-4">
    <h3 class="text-lg font-semibold mb-3">Quick Actions</h3>
    <div class="space-y-2">
        <a href="/waste/entry/" class="flex items-center p-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition">
            <i class="fas fa-trash-alt mr-3"></i>
            <div>
                <div class="font-medium">Record Waste</div>
                <div class="text-sm">Report wasted ingredients</div>
            </div>
        </a>
        <!-- Other actions... -->
    </div>
</div>

        <div class="flex items-center space-x-2">
          <button id="refresh-btn" class="px-3 py-2 bg-gray-700 rounded">
            Refresh
          </button>
          <button id="sound-btn" class="px-3 py-2 bg-gray-700 rounded">
            Sound
          </button>
          <button id="print-btn" class="px-3 py-2 bg-gray-700 rounded">
            Print
          </button>
          <button id="start-all-btn" class="px-3 py-2 bg-yellow-500 rounded">
            Start All
          </button>
          <button id="ready-all-btn" class="px-3 py-2 bg-green-500 rounded">
            Mark All Ready
          </button>
        </div>
      </div>

      <div class="grid grid-cols-3 gap-4">
        <div class="column bg-gray-800 p-4 rounded">
          <div class="flex justify-between items-center mb-4">
            <h2 class="font-semibold">Confirmed</h2>
            <div id="confirmed-count">0</div>
          </div>
          <div id="confirmed-orders" class="space-y-3"></div>
        </div>

        <div class="column bg-gray-800 p-4 rounded">
          <div class="flex justify-between items-center mb-4">
            <h2 class="font-semibold">Preparing</h2>
            <div>
              <div id="preparing-count">0</div>
            </div>
          </div>
          <div id="preparing-orders" class="space-y-3"></div>
        </div>

        <div class="column bg-gray-800 p-4 rounded">
          <div class="flex justify-between items-center mb-4">
            <h2 class="font-semibold">Ready</h2>
            <div id="ready-count">0</div>
          </div>
          <div id="ready-orders" class="space-y-3"></div>
        </div>
      </div>

      <div class="mt-6 grid grid-cols-3 gap-4 text-sm text-gray-400">
        <div>Average time: <span id="average-time">00:00</span></div>
        <div>Longest: <span id="longest-time">00:00</span></div>
        <div>Priority: <span id="priority-count">0</span></div>
      </div>

      <div class="mt-4 text-xs text-gray-500">
        Last update: <span id="last-update">-</span> Â· Time:
        <span id="current-time">-</span>
      </div>
    </div>

    <!-- Audio elements -->
    <!-- Audio: local fallback first (place files in static/audio/), then external CDN -->
    <audio id="new-order-sound" preload="auto" crossorigin="anonymous">
      <source
        src="/static/audio/mixkit-kitchen-timer-1001.mp3"
        type="audio/mpeg"
      />
      <source
        src="https://assets.mixkit.co/sfx/preview/mixkit-kitchen-timer-1001.mp3"
        type="audio/mpeg"
      />
    </audio>

    <audio id="order-ready-sound" preload="auto" crossorigin="anonymous">
      <source
        src="/static/audio/restaurant-bell-101396.mp3"
        type="audio/mpeg"
      />
      <source
        src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"
        type="audio/mpeg"
      />
    </audio>

    <!-- Hidden user data for JS -->
    <div
      id="user-data"
      data-user='{"username": "{{ user.username }}", "role": "{{ user.role }}"}'
    ></div>

    <!-- Toast container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- External JavaScript -->
    <script src="/static/js/auth-manager.js"></script>
    <script src="/static/js/chef-dashboard.js"></script>

    <script>
      // Minimal initialization script
      document.addEventListener("DOMContentLoaded", function () {
        // Update buttons with proper IDs for event listeners
        const refreshBtn = document.querySelector('button[onclick*="refresh"]');
        if (refreshBtn) {
          refreshBtn.id = "refresh-btn";
          refreshBtn.removeAttribute("onclick");
        }

        const soundBtn = document.querySelector(
          'button[onclick*="toggleSound"]'
        );
        if (soundBtn) {
          soundBtn.id = "sound-btn";
          soundBtn.removeAttribute("onclick");
        }

        const printBtn = document.querySelector('button[onclick*="print"]');
        if (printBtn) {
          printBtn.id = "print-btn";
          printBtn.removeAttribute("onclick");
        }

        const startAllBtn = document.querySelector(
          'button[onclick*="startAllPreparing"]'
        );
        if (startAllBtn) {
          startAllBtn.id = "start-all-btn";
          startAllBtn.removeAttribute("onclick");
        }

        const readyAllBtn = document.querySelector(
          'button[onclick*="markAllReady"]'
        );
        if (readyAllBtn) {
          readyAllBtn.id = "ready-all-btn";
          readyAllBtn.removeAttribute("onclick");
        }

        const clearReadyBtn = document.querySelector(
          'button[onclick*="clearAllReady"]'
        );
        if (clearReadyBtn) {
          clearReadyBtn.id = "clear-ready-btn";
          clearReadyBtn.removeAttribute("onclick");
        }

        // Remove all onclick attributes from order cards
        document
          .querySelectorAll('[onclick*="startPreparing"]')
          .forEach((btn) => btn.removeAttribute("onclick"));
        document
          .querySelectorAll('[onclick*="markAsReady"]')
          .forEach((btn) => btn.removeAttribute("onclick"));
        document
          .querySelectorAll('[onclick*="notifyWaiter"]')
          .forEach((btn) => btn.removeAttribute("onclick"));

        console.log("Chef template initialized for external JS");
      });
    </script>
  </body>
</html>
